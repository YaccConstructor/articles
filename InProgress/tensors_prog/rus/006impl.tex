% !TeX encoding = windows-1251
% !TeX spellcheck = ru_RU
% !TEX root = mainrus.tex

Прототип синтезатора реализован как клиент-серверное приложение\footnote{Прототип доступен по ссылке:
\url{https://se.math.spbu.ru/projects/genui} (проверено: \DTMDate{2024-11-11})}.
Со стороны клиента мы используем \textsc{HTML5} и \JavaScript для взаимодействия с сервером.
На сервере исполняется \OCaml приложение, оснащённое \OCanren и \Zthree.

%The prototype of our synthesizer is developed as a \mbox{client}/server application using web technologies\footnote{The implementation is available online
%for review: \url{https://genui.utbot.org}, username: ``public-user'', password: ``1jWMz2oWWmQW40hHSPZb'', no quotes.
%%In case it doesn't work try \url{https://se.math.spbu.ru/genui}.
%Generated design will be shown below specification field.}.
%On the client side we use \textsc{HTML5} for rendering and \OCaml
%compiled to \textsc{JavaScript} via \JSOO~\cite{JSOO} for a client-server interaction. The server side is a native \OCaml application equipped with \OCanren and \Zthree.

Чтобы облегчить пользователю представление структуры GUI и предписания, мы разработали два текстовых предметно-ориентированных языка.
В реализации выразительность языка предписаний расширена: мы разрешаем в правилах использовать пользовательские ограничения, присутствуют конструкции для задания табличных расположений, и т.п. Ни одно из расширений существенно не изменяет подход, описанный в предыдущих главах, и все расширения могут быть учтены.
Мы также параметризуем систему набором констант, которые определяют свойства окружения (например, размер холста, где мы располагаем элементы управления).
Пример описания структуры для диалогового окна настроек поиска сервиса Google Drive представлена на рис.~\ref{gd_structure}.
Текстовое описание предписания слишком длинное, чтобы представить его здесь.

%In order to provide end-users a way to represent GUI structures and guidelines we developed two textual DSLs. In addition in our implementation
%the expressivity of guidelines description was a little bit extended~--- for example, we actually allow the rules to be equipped with custom constraints, there are
%some extra constructs to express the guidelines for table-like layouts, etc. None of these extensions compromise the approach we
%described in the previous sections and all of them can rather easily be taken into account. We also parameterized our system with
%a set of constants which describe the common properties of the environment (for example, the size of the pane to place the synthesized layout in).
%An example of structure description for Google Drive search settings dialog is shown in Fig.~\ref{gd_structure}.
%The textual representation of guidelines, however, is too lengthy to show.


%\subsection{Client Side}
%A web page is essentially a text area for the user input of structure information in the syntax similar to that in Fig.~\ref{fig:evaluation},
%and a space for rendering results. The client-server interaction runs in several phases. The client sends structure information to the server and receives possibly many layouts. After that it sends the %layouts to the server one by one and receives the exact coordinates of the UI elements in the structure. The layouts which were successfully evaluated with \Zthree are being rendered in the end.

%\subsection{Server Side}
%The server side is implemented in \OCaml with assistance of \OCanren\footnote{
%\href{https://github.com/PLTools/OCanren}{https://github.com/PLTools/OCanren}
%\url{https://github.com/PLTools/OCanren}
%}~\cite{Zthree}, \noCanren\footnote{\url{https://github.com/Lozov-Petr/noCanren}}~\cite{lozov2017typed}
% and \Zthree~\cite{Zthree}. It could be separated into two parts: synthesis of a layout and evaluation of absolute coordinates.

%The synthesis of a layout is implemented mostly in functional style with assistance of \noCanren, which translates a dialect of \textsc{ML} to \OCanren. The exception is a
%confirmation check (described in Section~\ref{sec:synthesizing}) which is easier to implement in relational style because it applies non-deterministically many guideline rules.
%Encoding of the guideline rules themselves in \OCanren is error-prone because of inversion requirement. We implemented an embedded DSL for \OCaml for these guidelines
%which performs an inversion at compile time.

%We could name two drawbacks in our current implementation.  For now we have a limited amount of identifiers for UI elements (named by letters from A to J on
%Figure \ref{fig:evaluation}) which allows to represent our binary hypercube finitely, but
%reduces the expressivity of input structure definition. In future it shall be easily fixed because all possible structure definitions have a finite number
%of elements. Another drawback of our binary hypercube is an ability to encode nonsensical layouts (for example, one element subordinates another and vice versa).
%Right now these layouts are filtered out during the generation of absolute coordinates, but ideally we want them to be non-representable using type definitions of our synthesizer.

%The second part of server implementation is the calculation of absolute coordinates with assistance from \Zthree. This stage filters out problematical layouts and performs much
%faster than our relational synthesis. But we linked \OCaml and \Zthree to a single executable anyway  to avoid paying any costs  for inter process communication.

Для оценки нашего прототипа на промышленных примерах мы также реализовали отображение элементов управления с помощью Qt/QML.
На рис.~\ref{fig:QMLtwoGuidelines} можно увидеть два расположения структуры диалогового окна Google Drive, синтезированного
с учетом двух немного различных версий предписания, основанного на правилах проектирования интерфейсов от \textsc{JetBrains}~\cite{JBG}, нарисованные с помощью  QtQuick Controls\footnote{\url{https://doc.qt.io/qt-5/qtquick-controls2-qmlmodule.html} (проверено: \DTMDate{2024-11-11})} и темы оформления Microsoft Universal Design\footnote{\url{https://doc.qt.io/qt-6/qtquickcontrols-universal.html} (проверено: \DTMDate{2024-11-11})}.
Предписание регламентирует, что \enquote{слишком длинный} текст должен располагаться под меткой.
На правом расположении константа, регламентирующая свойство \enquote{слишком длинный} была уменьшена.
Синтез занял примерно 5 секунд.

Некоторые другие примеры можно найти на рис.~\ref{fig:evaluation}.

